{% extends "blog/base.html"%}
{% load static %}
{%block content%}
<div class="container background_v1">

    <div class="row">
        <div class="col-sm-12 col-md-4"> 
            <div class="profile_image_class">
                {% if profile.images%}
                <div style="width: 100%; position:relative;">
                    {%for image in profile.images.all %}
                        {% if forloop.last %}
                            <img src="{{image.image.url}}" class="profile_image">
                            <div class="fake_box"> </div>
                            <br />
                        {%endif%}
                    {%empty%}
                          <img src="{% static 'user.png' %}" class="profile_image">
                          <div class="fake_box"> </div>
                        <br />  
                    {%endfor%}
                </div>
                {%endif%}
            </div>
            <div class="profile_images_css">
                <a href="{% url 'profile_images' profile.id %}" style="margin:2%; width:96%;" class="btn btn-dark" >Więcej zdjęć</a>
                <button type="button" id="images_button" class="btn btn-dark">Schowaj zdjęcia</button>
                <div class="row" id="images_profile_box" style="padding:3px;">
                    {%for image in profile.images.all%}
                        <div class="col-md-6 col-lg-4" >
                            <div style="margin-top: 10px; position:relative;">
                                <a href="{{image.image.url}}" target="_blank"> 
                                    <img src="{{image.image.url}}" class="mini_profile_image" >
                                    <div class="mini_fake_box"></div>
                                </a>
                            </div>
                        </div>
                    {%endfor%}
                </div>
            </div>
            <div class="profile_images_css">
                <a href="{% url 'profile_friends' profile.id %}" style="margin:2%; width:96%;" class="btn btn-dark" >Wszyscy znajomi</a>
                <button type="button" id="friends_button" class="btn btn-dark">Schowaj znajomych</button>
                <div class="row" id="friends_profile_box">
                    {%for friend in profile.friends.all|slice:":6"%}
                        
                        <div class="col-md-6 col-lg-4" >
                            <div class="friend_image_box" style="padding:3px;"> 
                            <a href="{%url 'profile' friend.id%}" target="_blank"> 
                                {%for image in friend.images.all%}
                                    {%if forloop.last%}
                                        <div style="margin-top: 10px; position:relative;">
                                                <img src="{{image.image.url}}" class="mini_profile_image" >
                                                <div class="mini_fake_box"></div>
                                        </div>
                                    {%endif%}
                                {%endfor%}
                                    <div class="btn btn-dark"> <small>{{friend.get_name}}</small> </div>
                            </div>
                            </a>
                        </div>
                    {%endfor%}
                </div>
            </div>
            
        </div><!--4-->
        <div class="col-sm-12 col-md-8"> 
            <div class="profile_info" style="padding:10px;">
                <h1 style="color:black;">{{profile.get_name}}</h1>
                <button type="button" id="info_button" class="btn btn-dark">Więcej informacji</button>
                <div id="info">
                    <div class="container" >
                    Data urodzenia: {{profile.birth_date}} <br/>
                    {%if profile.country%}
                    Kraj: {{profile.country}}  <br/>   
                    {%endif%}
                    {%if profile.city%}
                    Miasto: {{profile.city}}  <br/>
                    {%endif%} 
                    {%if profile.gender %}
                    Płeć {{profile.gender}} <br/>
                    {% endif %}
                    {%if profile.weight %}
                    Waga: {{profile.weight}} <br/>
                    {% endif %}
                    {%if profile.height %}
                    Wzrost: {{profile.height}} <br/>
                    {% endif %}
                    {%if profile.description %}
                     Opis:  {{profile.description}}<br/>
                    {% endif %}
                    </div>
                </div>
            </div>
            <div class="profile_buttons" style="padding:10px;">
                <div class="row">
                {%if not  user.profile.id == profile.id%}
                    {%if not user.profile.id in friends_id %}
                        <div class="col-sm-12 col-md-4">
                            <form action="{%url 'create_friend_request' user.profile.id profile.id profile.id%}" method="POST">
                                {%csrf_token%}
                                <button type="submit" class="btn btn-dark" >Dodaj do znajomych</button>
                            </form>
                        </div>
                        {%else%}
                        <div class="col-sm-12 col-md-4">
                            <form action="{%url 'remove_friend' user.profile.id profile.id profile.id%}" method="POST" >
                                {%csrf_token%}
                                <button type="submit" class="btn btn-danger" >Usuń znajomego</button>
                            </form>
                            <br />
                        </div>
                        <div class="col-sm-12 col-md-4">
                            {%if have_chat%}
                            <a href="{% url 'chat' chat.id %}"  class="btn btn-dark">Chat</a>
                            {%else%}
                            <a href="{% url 'create_chat' profile.id %}"  class="btn btn-dark">Rozpocznij czat</a>
                            {%endif%}
                        </div>
                        {%endif%}
                {%endif%}
                {%if user.profile.id == profile.id%}
                    <div class="col-sm-12 col-md-4">
                    <a href="{%url 'edit_profile' profile.id%}" class="btn btn-dark">Edytuj</a>
                    </div>
                    <div class="col-sm-12 col-md-4">
                    <a href="{%url 'delete_profile' profile.id%}" class="btn btn-danger">Usuń konto</a>
                    </div>
                {%endif%}
            </div>
        </div>
        <div class="profile_posts_box">
            aaa
        </div> 
    </div><!--row-->
</div><!--Container--> 
<script>
const info_button = document.getElementById("info_button")
const info = document.getElementById("info")
let shown = false
info_button.addEventListener("click", function(){
if(shown){
    shown = false
    info.style.display="none"
    info_button.innerText="Pokaż więcej informacji"
}else{
    shown = true
    info.style.display="block"
    info_button.innerText="Pokaż mniej informacji"
}
})

const images_button = document.getElementById("images_button")
const images_profile_box = document.getElementById("images_profile_box")
let shown_2 = true
images_button.addEventListener("click", function(){
if(shown_2){
    shown_2 = false
    images_profile_box.style.display="none"
    images_button.innerText="Pokaż zdjęcia"
}else{
    shown_2 = true
    images_profile_box.style.display="flex"
    images_button.innerText="Schowaj zdjęcia"
}
})

const friends_button = document.getElementById("friends_button")
const friends_profile_box = document.getElementById("friends_profile_box")
let shown_3 = true
friends_button.addEventListener("click", function(){
if(shown_3){
    shown_3 = false
    friends_profile_box.style.display="none"
    friends_button.innerText="Pokaż znajomych"
}else{
    shown_3 = true
    friends_profile_box.style.display="flex"
    friends_button.innerText="Schowaj znajomych"
}
})

</script>
{% endblock %}